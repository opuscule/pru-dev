{% comment %}
  Shopify Cart Page - Classic Table Layout (Tailwind)
  Matches the "Product | Price | Quantity | Total" layout
{% endcomment %}

<section class="w-full bg-white py-12">
  <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">

    <!-- Page Title -->
    <h1 class="text-center font-semibold text-4xl md:text-5xl tracking-tight mb-10">
      {{ 'cart.title' | t }}
    </h1>

    <!-- Cart Form -->
    <form action="{{ routes.cart_url }}" method="post" class="space-y-8">

      <!-- Table Header -->
      <div class="hidden md:grid md:grid-cols-4 border-b border-gray-200 pb-3 font-medium text-gray-500 uppercase tracking-wide text-sm">
        <div>Product</div>
        <div class="text-center">Price</div>
        <div class="text-center">Quantity</div>
        <div class="text-right">Total</div>
      </div>

      {% for item in cart.items %}
      {% assign dob_val = item.product.metafields.custom.dob.value %}
      {% assign dob_ts = dob_val | date: "%s" | plus: 0 %}
      {% assign now_ts = 'now' | date: "%s" | plus: 0 %}
      {% assign diff_seconds = now_ts | minus: dob_ts %}
      {% assign weeks_old = diff_seconds | divided_by: 604800 %}

      <!-- Cart Row -->
      <div class="grid grid-cols-1 md:grid-cols-4 items-center border-b border-gray-100 py-6 gap-6">

        <!-- Product Info -->
        <div class="flex items-center gap-4">
          <div class="w-24 h-24 rounded-lg overflow-hidden border border-gray-200 flex-shrink-0">
            {% render 'image', image: item.image, url: item.url %}
          </div>
          <div class="space-y-1">
            <h2 class="font-semibold text-gray-900 text-lg leading-tight">{{ item.product.title }}</h2>
            <p class="text-sm text-gray-500">{{ item.product.metafields.custom.sex }} • {{ weeks_old | floor }} weeks old</p>
            <a href="{{ item.url_to_remove }}" class="text-xs text-red-500 hover:text-red-700 underline">
              Remove
            </a>
          </div>
        </div>

        <!-- Price -->
        <div class="text-gray-700 font-medium text-center md:text-left">
          {{ item.price | money }}
        </div>

        <!-- Quantity -->
        <div class="text-center">
          <quantity-input class="inline-flex items-center border border-gray-300 rounded-md">
            <button type="button" class="px-3 py-1 text-gray-600 hover:text-black">−</button>
            <input
              type="number"
              name="updates[]"
              value="{{ item.quantity }}"
              min="1"
              class="w-12 text-center border-x border-gray-300 focus:outline-none"
            >
            <button type="button" class="px-3 py-1 text-gray-600 hover:text-black">+</button>
          </quantity-input>
        </div>

        <!-- Total -->
        <div class="text-right font-semibold text-gray-900">
          {{ item.line_price | money }}
        </div>

      </div>
      {% endfor %}

      <!-- Cart Summary -->
      <div class="flex flex-col md:flex-row justify-between items-start md:items-center pt-8 gap-6">

        <div class="flex gap-4">
          <a href="{{ routes.all_products_collection_url }}" class="text-sm text-gray-600 hover:text-black underline">
            Continue Shopping
          </a>
        </div>

        <div class="w-full md:w-1/3 border border-gray-200 rounded-xl p-6 shadow-sm bg-gray-50">
          <div class="flex justify-between text-gray-700 mb-2">
            <span>Subtotal</span>
            <span class="font-semibold">{{ cart.total_price | money }}</span>
          </div>
          <p class="text-xs text-gray-400 mb-4">Taxes and shipping calculated at checkout</p>
          <input 
            type="submit" 
            name="checkout" 
            value="{{ 'cart.checkout' | t }}" 
            class="w-full bg-black text-white font-semibold py-3 rounded-md hover:bg-gray-900 transition"
          >
        </div>

      </div>
    </form>
  </div>
</section>

{% schema %}
{
  "name": "t:general.cart",
  "settings": []
}
{% endschema %}
